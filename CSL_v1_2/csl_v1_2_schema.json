{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/csl_v1_2_schema.json",
  "title": "CSL v1.2",
  "type": "object",
  "required": ["csl", "meta"],
  "properties": {
    "csl": { "type": "string", "const": "1.2" },
    "meta": { "type": "object" },
    "params": { "type": "array", "items": {"type": "object"} },
    "sketches": { "type": "array", "items": {"type": "object"} },
    "features": { "type": "array", "items": {"type": "object"} },
    "materials": { "type": "array", "items": {"type": "object"} },
    "export": { "type": "array", "items": {"type": "object"} },
    "thumbnail": { "type": "array", "items": {"type": "object"} },
    "assemblies": { "type": "array", "items": {"type": "object"} }
  },
  "additionalProperties": true,
  "allOf": [
    {
      "if": { "properties": { "sketches": {"contains": {"properties": {"entities": {"contains": {"properties": {"kind": {"const": "spline"}}}}}}}}},
      "then": { "properties": { "sketches": {"items": {"properties": {"entities": {"items": {"properties": {"degree": {"type": "integer", "minimum": 1}}}}}}}} }
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "loft"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "sections": {"type": "array"},
        "guides": {"type": "array"},
        "rail": {},
        "centerline": {},
        "continuity": {"type": "string", "enum": ["G0", "G1", "G2"]},
        "sections_continuity": {"type": "array", "items": {"type": "string", "enum": ["G0","G1","G2"]}},
        "orientation": {"type": "string", "enum": ["frenet","fixed_normal","binormal"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "fillet"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "edges": {"type": "array", "items": {"type": "object"}},
        "transitions": {"type": "string", "enum": ["setback", "rolling"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "chamfer"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "edges": {"type": "array", "items": {"type": "object"}}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "draft"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "faces": {},
        "neutral_plane": {},
        "angle": {},
        "pull_dir": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "emboss"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "depth": {},
        "draft": {},
        "direction": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "wrap"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "depth": {},
        "direction": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "project"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "along": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "thread"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "designation": {"type": "string"},
        "class": {"type": "string"},
        "pitch": {},
        "handedness": {"type": "string", "enum": ["right","left"]},
        "mode": {"type": "string", "enum": ["modeled","cosmetic"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "pattern"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "table": {"type": "array", "items": {"type": "object"}}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "patch"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"boundary": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "extend"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"distance": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "trim"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"tool": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "knit"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"targets": {"type": "array"}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "sheet_base"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"profile": {}, "thickness": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "edge_flange"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"edge": {}, "length": {}, "angle": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "bend"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"radius": {}, "relief": {}}}}}}
    },
    {
      "if": { "properties": { "assemblies": {"contains": {"properties": {"joints": {"type": "array"}}}}}},
      "then": { "properties": { "assemblies": {"items": {"properties": {
        "instances": {"type": "array", "items": {"type": "object"}},
        "joints": {"type": "array", "items": {"type": "object", "properties": {
          "type": {"type": "string", "enum": ["rigid","revolute","slider","cylindrical","pin_slot"]},
          "between": {"type": "array", "items": {}},
          "axis": {},
          "limits": {"type": "object", "properties": {"linear": {"type": "object"}, "angular": {"type": "object"}}},
          "damping": {},
          "preload": {}
        }}}
      }}}}}
    }
  ,
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "hole"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "type": {"type": "string", "enum": ["simple","counterbore","countersink","taper"]},
        "diameter": {},
        "depth": {},
        "drill_angle": {},
        "cbore": {"type": "object", "properties": {"diameter": {}, "depth": {}}},
        "csink": {"type": "object", "properties": {"diameter": {}, "angle": {}}},
        "taper": {"type": "object", "properties": {"angle": {}}},
        "on": {},
        "pattern": {"type": "object"}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "sweep"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "path": {},
        "profile": {},
        "orientation": {"type": "string", "enum": ["path","fixed","binormal","frenet"]},
        "twist": {},
        "scale": {},
        "rail": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "thin_extrude"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "profile": {}, "thickness": {}, "side": {"type": "string", "enum": ["one_side","two_sides","center"]}, "dual_wall": {"type": "boolean"}, "extent": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "rib"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "path": {}, "thickness": {}, "draft": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "move_face"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"faces": {}, "translate": {}, "rotate": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "offset_face"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"faces": {}, "distance": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "replace_face"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"target": {}, "with": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "split"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"body": {}, "by": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "mirror"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"bodies": {}, "across": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "unfold"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "refold"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "thread"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"target": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "pattern"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "kind": {"type": "string", "enum": ["linear","circular","grid","path","table"]},
        "linear": {"type": "object", "properties": {"axis1": {}, "axis2": {}, "spacing": {}, "extent": {}}},
        "circular": {"type": "object", "properties": {"axis": {}, "angle": {}, "count": {} }},
        "path": {"type": "object", "properties": {"path": {}, "spacing": {}, "align_to_path": {"type": "boolean"}}}
      }}}}}
    },
    {
      "if": { "properties": { "assemblies": { "contains": { "properties": { "instances": { "type": "array" } } } } } },
      "then": {
        "properties": {
          "assemblies": {
            "items": {
              "properties": {
                "instances": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": { "type": "string" },
                      "of": {},
                      "at": {
                        "type": "object",
                        "properties": {
                          "transform": {
                            "type": "object",
                            "properties": {
                              "matrix": { "type": "array", "items": { "type": "number" }, "minItems": 16, "maxItems": 16 },
                              "translate": {},
                              "rotate": {},
                              "scale": {}
                            },
                            "additionalProperties": true
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "helix"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"axis": {}, "pitch": {}, "turns": {}, "height": {}, "start_radius": {}}}}}}
    },
    {
      "if": { "properties": { "pmi": {"type": "array"}}},
      "then": { "properties": { "pmi": {"items": {"type": "object", "properties": {"kind": {"type": "string", "enum": ["note","gdt"]}, "target": {}, "text": {}, "frame": {}}}}}}
    }
  ]
}


