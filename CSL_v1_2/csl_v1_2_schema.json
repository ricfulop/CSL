{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/csl_v1_2_schema.json",
  "title": "CSL v1.2",
  "type": "object",
  "required": ["csl", "meta"],
  "properties": {
    "csl": { "type": "string", "const": "1.2" },
    "meta": { "type": "object" },
    "params": { "type": "array", "items": {"type": "object"} },
    "sketches": { "type": "array", "items": {"type": "object"} },
    "features": { "type": "array", "items": {"type": "object"} },
    "materials": { "type": "array", "items": {"type": "object"} },
    "export": { "type": "array", "items": {"type": "object"} },
    "thumbnail": { "type": "array", "items": {"type": "object"} },
    "assemblies": { "type": "array", "items": {"type": "object"} }
  },
  "additionalProperties": true,
  "allOf": [
    {
      "if": { "properties": { "sketches": {"contains": {"properties": {"entities": {"contains": {"properties": {"kind": {"const": "spline"}}}}}}}}},
      "then": { "properties": { "sketches": {"items": {"properties": {"entities": {"items": {"properties": {"degree": {"type": "integer", "minimum": 1}}}}}}}} }
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "loft"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "sections": {"type": "array"},
        "guides": {"type": "array"},
        "rail": {},
        "centerline": {},
        "continuity": {"type": "string", "enum": ["G0", "G1", "G2"]},
        "sections_continuity": {"type": "array", "items": {"type": "string", "enum": ["G0","G1","G2"]}},
        "orientation": {"type": "string", "enum": ["frenet","fixed_normal","binormal"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "fillet"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "edges": {"type": "array", "items": {"type": "object"}},
        "transitions": {"type": "string", "enum": ["setback", "rolling"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "chamfer"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "edges": {"type": "array", "items": {"type": "object"}}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "draft"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "faces": {},
        "neutral_plane": {},
        "angle": {},
        "pull_dir": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "emboss"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "depth": {},
        "draft": {},
        "direction": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "wrap"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "depth": {},
        "direction": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "project"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "onto": {},
        "along": {}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "thread"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "designation": {"type": "string"},
        "class": {"type": "string"},
        "pitch": {},
        "handedness": {"type": "string", "enum": ["right","left"]},
        "mode": {"type": "string", "enum": ["modeled","cosmetic"]}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "pattern"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {
        "table": {"type": "array", "items": {"type": "object"}}
      }}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "patch"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"boundary": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "extend"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"distance": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "trim"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"tool": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "knit"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"targets": {"type": "array"}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "sheet_base"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"profile": {}, "thickness": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "edge_flange"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"edge": {}, "length": {}, "angle": {}}}}}}
    },
    {
      "if": { "properties": { "features": {"contains": {"properties": {"kind": {"const": "bend"}}}}}},
      "then": { "properties": { "features": {"items": {"properties": {"radius": {}, "relief": {}}}}}}
    },
    {
      "if": { "properties": { "assemblies": {"contains": {"properties": {"joints": {"type": "array"}}}}}},
      "then": { "properties": { "assemblies": {"items": {"properties": {
        "instances": {"type": "array", "items": {"type": "object"}},
        "joints": {"type": "array", "items": {"type": "object", "properties": {
          "type": {"type": "string", "enum": ["rigid","revolute","slider","cylindrical","pin_slot"]},
          "between": {"type": "array", "items": {}},
          "axis": {},
          "limits": {"type": "object", "properties": {"linear": {"type": "object"}, "angular": {"type": "object"}}},
          "damping": {},
          "preload": {}
        }}}
      }}}}}
    }
  ]
}


